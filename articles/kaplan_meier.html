<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Kaplan-Meier Guideline Suggestions • grstat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Kaplan-Meier Guideline Suggestions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9013</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adverse_events_sas.html">Adverse Events : Macros SAS</a></li>
    <li><a class="dropdown-item" href="../articles/kaplan_meier.html">Kaplan-Meier Guideline Suggestions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/oncostat/grstat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Kaplan-Meier Guideline Suggestions</h1>
                        <h4 data-toc-skip class="author">Livia
Pierotti</h4>
            
            <h4 data-toc-skip class="date">2024-11-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oncostat/grstat/blob/main/vignettes/kaplan_meier.Rmd" class="external-link"><code>vignettes/kaplan_meier.Rmd</code></a></small>
      <div class="d-none name"><code>kaplan_meier.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette illustrates the implementation of Kaplan-Meier survival
analysis in R using the survival and <code>ggsurvfit</code> packages.
The Kaplan-Meier method is a standard approach in clinical research for
estimating survival functions and comparing time-to-event outcomes
between groups.</p>
<p>In this example, two key survival endpoints are analysed:</p>
<ul>
<li><p>Progression-Free Survival (PFS): Defined as the time from
treatment initiation to either disease progression or death.</p></li>
<li><p>Overall Survival (OS): Defined as the time from treatment
initiation to death from any cause.</p></li>
</ul>
<p>This vignette covers the following steps:</p>
<ul>
<li><p>Preparation of the dataset.</p></li>
<li><p>Creation of time-to-event and event indicator variables.</p></li>
<li><p>Fitting of Kaplan-Meier models.</p></li>
<li><p>Visualization of survival curves accompanied by risk
tables.</p></li>
</ul>
<p>The approach presented here follows the recommendations provided by
Daniel Sjoberg’s <code>ggsurvfit</code> package for generating
publication-ready Kaplan-Meier plots.</p>
<p>First, install packages if needed and load them.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load libraries</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://oncostat.github.io/grstat/">grstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pharmaverse/ggsurvfit" class="external-link">ggsurvfit</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<div class="section level3">
<h3 id="data-overview">Data Overview<a class="anchor" aria-label="anchor" href="#data-overview"></a>
</h3>
<p>The dataset used is an extension of the dataset provided by the
<code>ggsurvfit</code> package. Additional variables were simulated to
resemble to a typical dataset from an oncology clinical study, including
information on progression status, survival times, and treatment
characteristics. <strong>Note:</strong> In this example, the end date is
determined using the <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax()</a></code> function, which selects the
latest available date from the following: date of death, last visit,
last RECIST scan, last patient contact, end of treatment, or last
follow-up.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Display dataset</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_surv</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;      id death date_start date_progression date_end   surg                       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     1 2021-04-16 2021-04-18       2021-04-19 Limited Time Since Surgery </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2     0 2021-05-20 2021-05-25       2021-05-28 Limited Time Since Surgery </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3     1 2021-03-27 <span style="color: #BB0000;">NA</span>               2021-03-28 Limited Time Since Surgery </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4     1 2021-05-14 <span style="color: #BB0000;">NA</span>               2021-05-15 Extended Time Since Surgery</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5     1 2021-05-27 <span style="color: #BB0000;">NA</span>               2021-05-28 Extended Time Since Surgery</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     6     1 2021-06-06 <span style="color: #BB0000;">NA</span>               2021-06-09 Limited Time Since Surgery</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data_surv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 929   6</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="variable-creation">Variable Creation<a class="anchor" aria-label="anchor" href="#variable-creation"></a>
</h3>
<p>The purpose of this section is to create status and time status and
time variables for Progression-Free Survival (PFS) and Overall Survival
(OS).</p>
<p>First, the variables time and status (indicating whether an event
occurred or was censored) need to be created to enable the use of
various functions.</p>
<ul>
<li>
<p>Time variable:</p>
<p>The time variable represents the duration from a defined starting
point (e.g., diagnosis, study enrollment, or start of treatment) to the
time at which the patient’s status is recorded (e.g. death, disease
progression, recurrence or last news). It is a numeric variable measured
in units such as days, months, or years, depending on the study’s
duration and requirements.</p>
</li>
<li><p>Status variable: The status variable is binary, indicating
whether the event has occurred (event = 1) or not (censored = 0) for
each subject by the end of the study period.</p></li>
</ul>
<p>An event (1) indicates that the subjects experienced the event of
interest (e.g., death, relapse, transplant failure, etc.).</p>
<p>Censored (0) refers to those subjects who did not experience the
event during the study. For these individuals, the ‘time-to-event’ is
considered censored, indicating that we only know they did not
experience the event up to a certain point.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Example</span></span>
<span></span>
<span><span class="va">data_surv_v2</span> <span class="op">=</span> <span class="va">data_surv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    status_PFS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">date_progression</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span> <span class="op">)</span>,</span>
<span>    date_status_pfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">date_progression</span>,<span class="va">date_end</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    status_OS <span class="op">=</span> <span class="va">death</span>,</span>
<span>    date_status_OS <span class="op">=</span> <span class="va">date_end</span>,</span>
<span>    time_pfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">date_status_pfs</span><span class="op">-</span><span class="va">date_start</span><span class="op">)</span><span class="op">/</span><span class="fl">30.5</span>,</span>
<span>    time_OS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">date_status_OS</span><span class="op">-</span><span class="va">date_start</span><span class="op">)</span><span class="op">/</span><span class="fl">30.5</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">time_pfs</span>,<span class="va">time_OS</span>,<span class="va">status_PFS</span>,<span class="va">status_OS</span>,<span class="va">surg</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_surv_v2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;      id time_pfs time_OS status_PFS status_OS surg                       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1   0.061<span style="text-decoration: underline;">1</span>  0.086<span style="text-decoration: underline;">9</span>          1         1 Limited Time Since Surgery </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2   0.175   0.277           1         0 Limited Time Since Surgery </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3   0.048<span style="text-decoration: underline;">7</span>  0.048<span style="text-decoration: underline;">7</span>          0         1 Limited Time Since Surgery </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4   0.022<span style="text-decoration: underline;">0</span>  0.022<span style="text-decoration: underline;">0</span>          0         1 Extended Time Since Surgery</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5   0.046<span style="text-decoration: underline;">9</span>  0.046<span style="text-decoration: underline;">9</span>          0         1 Extended Time Since Surgery</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     6   0.081<span style="text-decoration: underline;">1</span>  0.081<span style="text-decoration: underline;">1</span>          0         1 Limited Time Since Surgery</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="kaplan-meier-analysis">Kaplan-Meier Analysis<a class="anchor" aria-label="anchor" href="#kaplan-meier-analysis"></a>
</h2>
<div class="section level3">
<h3 id="generate-survival-estimates-using-survfit2">Generate survival estimates using <code>survfit2()</code><a class="anchor" aria-label="anchor" href="#generate-survival-estimates-using-survfit2"></a>
</h3>
<p>We recommend using the <code>ggsurvfit</code> package which uses
<code><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html" class="external-link">survfit2()</a></code>with the following syntax:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km.model_PFS</span> <span class="op">=</span> <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html" class="external-link">survfit2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time_pfs</span>, <span class="va">status_PFS</span><span class="op">)</span> <span class="op">~</span> <span class="va">surg</span>,data <span class="op">=</span> <span class="va">data_surv_v2</span><span class="op">)</span></span>
<span><span class="va">km.model_PFS</span></span>
<span><span class="co">#&gt; Call: survfit(formula = Surv(time_pfs, status_PFS) ~ surg, data = data_surv_v2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                    n events median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; surg=Limited Time Since Surgery  682    372  0.149   0.141   0.157</span></span>
<span><span class="co">#&gt; surg=Extended Time Since Surgery 247    111  0.149   0.141   0.197</span></span>
<span></span>
<span><span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/tidy_survfit.html" class="external-link">tidy_survfit</a></span><span class="op">(</span><span class="va">km.model_PFS</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.20</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">strata</span>, <span class="va">time</span>, <span class="va">n.risk</span>, <span class="va">n.event</span>, <span class="va">estimate</span>, <span class="va">conf.high</span>, <span class="va">conf.low</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   strata                       time n.risk n.event estimate conf.high conf.low</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Extended Time Since Surgery  0.05    136      60    0.723     0.786    0.665</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Extended Time Since Surgery  0.1     114       9    0.673     0.741    0.612</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Extended Time Since Surgery  0.2      39      41    0.403     0.486    0.333</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Limited Time Since Surgery   0.05    429     156    0.753     0.788    0.720</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Limited Time Since Surgery   0.1     368      32    0.695     0.733    0.659</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Limited Time Since Surgery   0.2     101     176    0.337     0.382    0.298</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-survival-curves">Generate survival curves<a class="anchor" aria-label="anchor" href="#generate-survival-curves"></a>
</h3>
<p>For full documentation on <code>ggsurvfit</code>, visit the <a href="https://www.danieldsjoberg.com/ggsurvfit/articles/gallery.html#kmunicate" class="external-link">ggsurvfit
website</a>.</p>
<p>To cite their work, refer to the following:</p>
<blockquote>
<p>Sjoberg D, Baillie M, Fruechtenicht C, Haesendonckx S, Treis T
(2025). <em>ggsurvfit: Flexible Time-to-Event Figures.</em><br>
R package version 1.1.0. Available at: <a href="https://www.danieldsjoberg.com/ggsurvfit/" class="external-link uri">https://www.danieldsjoberg.com/ggsurvfit/</a>.</p>
</blockquote>
<div class="section level4">
<h4 id="progression-free-survival-pfs">Progression-Free Survival (PFS)<a class="anchor" aria-label="anchor" href="#progression-free-survival-pfs"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_PFS</span> <span class="op">=</span> <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html" class="external-link">survfit2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time_pfs</span>, <span class="va">status_PFS</span><span class="op">)</span> <span class="op">~</span> <span class="va">surg</span>, data <span class="op">=</span> <span class="va">data_surv_v2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/ggsurvfit.html" class="external-link">ggsurvfit</a></span><span class="op">(</span>linetype_aes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_confidence_interval.html" class="external-link">add_confidence_interval</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_risktable.html" class="external-link">add_risktable</a></span><span class="op">(</span></span>
<span>    risktable_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n.risk"</span>, <span class="st">"cum.censor"</span>, <span class="st">"cum.event"</span> <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/theme_ggsurvfit.html" class="external-link">theme_ggsurvfit_KMunicate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"inside"</span>, legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">km_PFS</span></span></code></pre></div>
<p><img src="kaplan_meier_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p><strong>This plot can be further customised, for
example:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_PFS</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_censor_mark.html" class="external-link">add_censor_mark</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time from beginning of treatment to progression or death (months)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Progression-Free Survival"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Progression-Free Survival, (N=929, n event=440)"</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="kaplan_meier_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="overall-survival-os">Overall Survival (OS)<a class="anchor" aria-label="anchor" href="#overall-survival-os"></a>
</h4>
<p>The function <code><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/scale_ggsurvfit.html" class="external-link">scale_ggsurvfit()</a></code> can be used to
automatically adjust the axes limits of Kaplan-Meier plots to better fit
the data and improve visualisation. <strong>Note:</strong> The
<code><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/scale_ggsurvfit.html" class="external-link">scale_ggsurvfit()</a></code> function automatically scales the y-axis
in percentage.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_OS</span> <span class="op">=</span> <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html" class="external-link">survfit2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time_OS</span>, <span class="va">status_OS</span><span class="op">)</span> <span class="op">~</span> <span class="va">surg</span>, data <span class="op">=</span> <span class="va">data_surv_v2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/ggsurvfit.html" class="external-link">ggsurvfit</a></span><span class="op">(</span>linetype_aes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_confidence_interval.html" class="external-link">add_confidence_interval</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_risktable.html" class="external-link">add_risktable</a></span><span class="op">(</span></span>
<span>    risktable_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n.risk"</span>, <span class="st">"cum.event"</span> <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/theme_ggsurvfit.html" class="external-link">theme_ggsurvfit_KMunicate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/scale_ggsurvfit.html" class="external-link">scale_ggsurvfit</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>, legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_OS</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_censor_mark.html" class="external-link">add_censor_mark</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time from beginning of treatment to death (months)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Overall Survival"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Overall Survival, (N=929, n event=468)"</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p><img src="kaplan_meier_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.gustaveroussy.fr/fr/oncostat" class="external-link">Team Oncostat</a>, Dan Chaltiel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
